{"ast":null,"code":"import _slicedToArray from\"/Users/kiranmanikonda/react_projects/memories_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{AppBar,Typography,Toolbar,Avatar,Button}from'@material-ui/core';import{Link,useNavigate,useLocation}from'react-router-dom';import{useDispatch}from'react-redux';import decode from'jwt-decode';import*as actionType from'../../constants/actionTypes';import memories from'../../images/memories.png';import useStyles from'./styles';// navbar at the top of main posts page\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Navbar=function Navbar(){// user data\nvar _useState=useState(JSON.parse(localStorage.getItem('profile'))),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var dispatch=useDispatch();var location=useLocation();var history=useNavigate();var classes=useStyles();// login + go back to signin / signup\nvar logout=function logout(){dispatch({type:actionType.LOGOUT});history('/auth');setUser(null);console.log('logged out');};// handle token expiry\nuseEffect(function(){var token=user===null||user===void 0?void 0:user.token;if(token){var decodedToken=decode(token);if(decodedToken.exp*1000<new Date().getTime())logout();setUser(JSON.parse(localStorage.getItem('profile')));}setUser(JSON.parse(localStorage.getItem('profile')));},[location]);return/*#__PURE__*/_jsxs(AppBar,{className:classes.appBar,position:\"static\",color:\"inherit\",children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.brandContainer,children:[/*#__PURE__*/_jsx(Typography,{component:Link,to:\"/\",className:classes.heading,variant:\"h2\",align:\"center\",children:\"Memories\"}),/*#__PURE__*/_jsx(\"img\",{className:classes.image,src:memories,alt:\"icon\",height:\"60\"})]}),/*#__PURE__*/_jsx(Toolbar,{className:classes.toolbar,children:user?/*#__PURE__*/_jsxs(\"div\",{className:classes.profile,children:[/*#__PURE__*/_jsx(Avatar,{className:classes.purple,alt:user===null||user===void 0?void 0:user.result.name,src:user===null||user===void 0?void 0:user.result.imageUrl,children:user===null||user===void 0?void 0:user.result.name.charAt(0)}),/*#__PURE__*/_jsx(Typography,{className:classes.userName,variant:\"h6\",children:user===null||user===void 0?void 0:user.result.name}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",className:classes.logout,color:\"secondary\",onClick:logout,children:\"Logout\"})]}):/*#__PURE__*/_jsx(Button,{component:Link,to:\"/auth\",variant:\"contained\",color:\"primary\",children:\"Sign In\"})})]});};export default Navbar;","map":{"version":3,"names":["React","useState","useEffect","AppBar","Typography","Toolbar","Avatar","Button","Link","useNavigate","useLocation","useDispatch","decode","actionType","memories","useStyles","Navbar","JSON","parse","localStorage","getItem","user","setUser","dispatch","location","history","classes","logout","type","LOGOUT","console","log","token","decodedToken","exp","Date","getTime","appBar","brandContainer","heading","image","toolbar","profile","purple","result","name","imageUrl","charAt","userName"],"sources":["/Users/kiranmanikonda/react_projects/memories_app/client/src/components/Navbar/Navbar.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { AppBar, Typography, Toolbar, Avatar, Button } from '@material-ui/core';\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\nimport { useDispatch } from 'react-redux';\nimport decode from 'jwt-decode';\nimport * as actionType from '../../constants/actionTypes';\n\nimport memories from '../../images/memories.png';\nimport useStyles from './styles';\n\n\n// navbar at the top of main posts page\n\nconst Navbar = () => {\n    // user data\n    const [user, setUser] = useState(JSON.parse(localStorage.getItem('profile')));\n    const dispatch = useDispatch();\n    const location = useLocation();\n    const history = useNavigate();\n\n    const classes = useStyles();\n\n    // login + go back to signin / signup\n    const logout = () => {\n        dispatch({ type: actionType.LOGOUT });\n        history('/auth');\n        setUser(null);\n        console.log('logged out');\n      };\n\n    // handle token expiry\n    useEffect(() => {\n        const token = user?.token;\n        if (token) {\n          const decodedToken = decode(token);\n          if (decodedToken.exp * 1000 < new Date().getTime()) logout();\n          setUser(JSON.parse(localStorage.getItem('profile')));\n        }\n        setUser(JSON.parse(localStorage.getItem('profile')));\n      }, [location]);\n    \n    return (\n        <AppBar className={classes.appBar} position=\"static\" color=\"inherit\">\n            <div className={classes.brandContainer}>\n                <Typography component={Link} to=\"/\" className={classes.heading} variant=\"h2\" align=\"center\">Memories</Typography>\n                <img className={classes.image} src={memories} alt=\"icon\" height=\"60\" />\n            </div>\n            <Toolbar className={classes.toolbar}>\n                {user ? (\n                <div className={classes.profile}>\n                    <Avatar className={classes.purple} alt={user?.result.name} src={user?.result.imageUrl}>{user?.result.name.charAt(0)}</Avatar>\n                    <Typography className={classes.userName} variant=\"h6\">{user?.result.name}</Typography>\n                    <Button variant=\"contained\" className={classes.logout} color=\"secondary\" onClick={logout}>Logout</Button>\n                </div>\n                ) : (\n                <Button component={Link} to=\"/auth\" variant=\"contained\" color=\"primary\">Sign In</Button>\n                )}\n            </Toolbar>\n        </AppBar>\n    )\n};\n\nexport default Navbar;"],"mappings":"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"},"metadata":{},"sourceType":"module"}